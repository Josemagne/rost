(window.ppWebpackJsonp=window.ppWebpackJsonp||[]).push([[24],{312:function(e,n,t){"use strict";t.r(n),t.d(n,"initializeKlpWidget",function(){return initializeKlpWidget});t(183),t(23),t(33),t(45),t(6),t(5),t(100),t(251),t(24),t(82),t(131),t(101),t(7),t(2),t(55);var i=t(252),o=t.n(i);t(281);function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,n){if(!e)return;if("string"==typeof e)return _arrayLikeToArray(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _arrayLikeToArray(e,n)}(e))){var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,a=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function _arrayLikeToArray(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=a||{};function initializeKlpWidget(e,n){try{window.OPPklpWidget=window.klpWidgetDev(e,n.applicationId,n.serviceId,n.appLoginUrl,null,n.currentLang,n.platform,n.options),document.dispatchEvent(new CustomEvent("wepploginwidget_widget_ready"))}catch(e){console.error(e)}}!function(e){a.EventBus=function(n,t){var i=this,o=new e(n,void 0,t),s={},c={},r=a.EventBus.CONNECTING,l=null,d=null;function sendPing(){o.send(JSON.stringify({type:"ping"}))}function sendOrPub(e,n,t,a){checkSpecified("address","string",n),checkSpecified("replyHandler","function",a,!0),checkOpen();var s={type:e,address:n,body:t};if(i.sessionID&&(s.sessionID=i.sessionID),a){var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e,n){return n=16*Math.random(),("y"===e?3&n|8:0|n).toString(16)});s.replyAddress=r,c[r]=a}var l=JSON.stringify(s);o.send(l)}function checkOpen(){if(r!==a.EventBus.OPEN)throw new Error("INVALID_STATE_ERR")}function checkSpecified(e,n,t,i){if(!i&&!t)throw new Error("Parameter "+e+" must be specified");if(t&&_typeof(t)!==n)throw new Error("Parameter "+e+" must be of type "+n)}t&&(d=t.vertxbus_ping_interval),d||(d=5e3),i.onopen=null,i.onclose=null,i.login=function(e,n,t){sendOrPub("send","vertx.basicauthmanager.login",{username:e,password:n},function(e){"ok"===e.status&&(i.sessionID=e.sessionID),t&&(delete e.sessionID,t(e))})},i.send=function(e,n,t){sendOrPub("send",e,n,t)},i.publish=function(e,n){sendOrPub("publish",e,n,null)},i.registerHandler=function(e,n){checkSpecified("address","string",e),checkSpecified("handler","function",n),checkOpen();var t=s[e];if(t)t[t.length]=n;else{t=[n],s[e]=t;var i={type:"register",address:e};o.send(JSON.stringify(i))}},i.unregisterHandler=function(e,n){checkSpecified("address","string",e),checkSpecified("handler","function",n),checkOpen();var t=s[e];if(t){var i=t.indexOf(n);if(-1!==i&&t.splice(i,1),0===t.length){var a={type:"unregister",address:e};o.send(JSON.stringify(a)),delete s[e]}}},i.close=function(){checkOpen(),r=a.EventBus.CLOSING,o.close()},i.readyState=function(){return r},o.onopen=function(){sendPing(),l=setInterval(sendPing,d),r=a.EventBus.OPEN,i.onopen&&i.onopen()},o.onclose=function(){r=a.EventBus.CLOSED,l&&clearInterval(l),i.onclose&&i.onclose()},o.onmessage=function(e){var n,t=e.data,o=JSON.parse(t),a=o.body,r=o.replyAddress,l=o.address;r&&(n=function(e,n){i.send(r,e,n)});var d=s[l];if(d)for(var u=d.slice(0),g=0;g<u.length;g++)u[g](a,n);else{var p=c[l];p&&(delete c[l],p(a,n))}}},a.EventBus.CONNECTING=0,a.EventBus.OPEN=1,a.EventBus.CLOSING=2,a.EventBus.CLOSED=3,a.EventBus}(o.a),function(e){window.klpWidgetDev=function(n,t,i,o,s,c,r,l){var d=document.getElementsByTagName("header")[0];new MutationObserver(function(t,i){var o,a=_createForOfIteratorHelper(t);try{for(a.s();!(o=a.n()).done;)"class"===o.value.attributeName&&e("header").hasClass("h-fixed-position")&&!e("header").hasClass("h-visible")&&(e(".klp-widget-authenticated-menu").css("display","none"),e("#"+n).removeClass("bubble"))}catch(e){a.e(e)}finally{a.f()}}).observe(d,{attributes:!0,childList:!1,subtree:!1});var u,g="klp-widget-keepalive",p="klp.widget.state",v="klp.widget.document.",f="NCTRL",m="post.ch",h=new RegExp(m+"$"),b=new RegExp(f+"=([^;]+)"),k=void 0,w=void 0,y=!1,x=void 0,C=void 0,S=void 0,L=void 0,A={},D="UNREAD_NOTIFICATIONS",I=!0,P=void 0,O="de",N=(new Date).getTime(),T=0,_={de:{"sign-in":"Login","sign-out":"Logout","change-company":"Firma wählen","change-company-confirm-dialog":'Möchten Sie die aktuelle Firma wechseln? </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Firma wählen</button>',"change-company-support-dialog":'Im Kunden-Supportlogin steht die Funktion "Firma wechseln" nicht zur Verfügung. Führen Sie stattdessen ein Logout durch und starten Sie das Kunden-Supportlogin auf einem neuen Benutzer oder einer neuen Firma. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Logout</button>',"change-account":"Benutzerkonto wechseln","change-account-confirm-dialog":'Möchten Sie in ein anderes Benutzerkonto wechseln? </p></div></div><div class="modal-button-container row"><div class="item-centered d-flex justify-content-center col-lg-12 col-12 pr-0 mr-0"><div class="col-lg-4 col-12 mr-0 pr-0"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary w-100">Weiter</button>',"change-account-support-dialog":'Im Kunden-Supportlogin steht die Funktion "Benutzerkonto wechseln" nicht zur Verfügung. Führen Sie stattdessen ein Logout durch und starten Sie das Kunden-Supportlogin auf einem neuen Benutzer oder einer neuen Firma. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Logout</button>',links:"Meine Onlinedienste",notifications:"Meldungen","toggle-menu":"toggle-menu","no-links":"Keine Favoriten bei Onlinedienste","no-notifications":"Keine ungelesenen Meldungen","more-notifications":"Alle Meldungen","title-text-menu":"Meine Übersicht","title-text-links":"Meine Onlinedienste","title-text-notifications":"Nachrichten",userProfile:"Mein Profil"},fr:{"sign-in":"Login","sign-out":"Logout","change-company":"Changer entreprise","change-company-confirm-dialog":'Voulez-vous quitter l\'entreprise actuelle? </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Changer enterprise</button>.',"change-company-support-dialog":'Dans le Login-Support, la fonction changer entreprise n\'est pas disponible. Il faut quitter la session et puis démarrer un nouveau Login-Support avec un autre compte ou une société différente. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Déconnexion</button>',"change-account":"Changer de compte","change-account-confirm-dialog":'Vous souhaitez changer de compte utilisateur? </p></div></div><div class="modal-button-container row"><div class="item-centered d-flex justify-content-center col-lg-12 col-12 pr-0 mr-0"><div class="col-lg-4 col-12 mr-0 pr-0"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary w-100">Continuer</button>',"change-account-support-dialog":'La fonction "Changer de compte" n\'est pas disponible dans le login de support client. Déconnectez-vous et démarrez le login de support client sur un autre compte utilisateur ou d\'entreprise. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Déconnexion</button>',links:"Mes services en ligne",notifications:"notifications","toggle-menu":"toggle-menu","no-links":"Pas de favoris","no-notifications":"Pas de notifications non lues","more-notifications":"Toutes les notifications","title-text-menu":"Mon compte","title-text-links":"Mes services en ligne","title-text-notifications":"Messages",userProfile:"Mon profil"},it:{"sign-in":"Login","sign-out":"Logout","change-company":"Cambia la ditta","change-company-confirm-dialog":'È sicuro di voler uscire dall\'attuale ditta? </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Cambia la ditta</button>',"change-company-support-dialog":'Nell\'Assistenza clienti, il cambiamento di ditta non è disponibile. Bisogna prima eseguire un Logout, quindi avviare nuovamente l\'Assistenza clienti selezionando un utente o una ditta differente. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Logout</button>',"change-account":"Cambia account utente","change-account-confirm-dialog":'Desidera accedere con un altro account utente? </p></div></div><div class="modal-button-container row"><div class="item-centered d-flex justify-content-center col-lg-12 col-12 pr-0 mr-0"><div class="col-lg-4 col-12 mr-0 pr-0"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary w-100">Avanti</button>',"change-account-support-dialog":'Nel login assistenza clienti non è disponibile la funzione "Modifica account utente". Si consiglia di effettuare il logout, quindi di riaccedere al login assistenza clienti tramite un nuovo account utente o una nuova ditta. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Logout</button>',links:"I miei servizi online",notifications:"notifiche","toggle-menu":"toggle-menu","no-links":"Nessun preferito","no-notifications":"Nessuna notifica non letta","more-notifications":"Tutte le notifiche","title-text-menu":"Il mio riepilogo","title-text-links":"I miei servizi online","title-text-notifications":"Messaggi",userProfile:"Il mio profilo"},en:{"sign-in":"Login","sign-out":"Logout","change-company":"Change company","change-company-confirm-dialog":'Would you like to sign-out from the current company? </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Next</button>.',"change-company-support-dialog":'On Kunden-Supportlogin, the function Change company is not available. You have to SignOut and then start again a new Kunden-Supportlogin selecting a different account or company. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Logout</button>',"change-account":"Change user account","change-account-confirm-dialog":'Do you want to change to another user account? </p></div></div><div class="modal-button-container row"><div class="item-centered d-flex justify-content-center col-lg-12 col-12 pr-0 mr-0"><div class="col-lg-4 col-12 mr-0 pr-0"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary w-100">Next</button>',"change-account-support-dialog":'The "Change user account" function is not available in the customer support login. Instead, log out and start the customer support login using a new user or new company. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Logout</button>',links:"My online services",notifications:"notifications","toggle-menu":"toggle-menu","no-links":"No favorites","no-notifications":"No unread notifications","more-notifications":"All notifications","title-text-menu":"My overview","title-text-links":"My online services","title-text-notifications":"Inbox",userProfile:"My Profile"}},E={"sign-in":{"access-key":"i","tab-index":0},"sign-out":{"access-key":"o","tab-index":3},"toggle-menu":{"access-key":"m","tab-index":0},"change-company":{"access-key":"c","tab-index":2},"change-account":{"access-key":"c","tab-index":2},notifications:{"access-key":"n","tab-index":1},links:{"access-key":"l","tab-index":4}},M={audit:r.endPoint+"/v1/audit",keepalive:r.endPoint+"/v1/session/keepalive",subscribe:r.endPoint+"/v1/session/subscribe",eventbus:r.endPoint+"/eventbus"},U={logoutTargetURL:"",keepAlive:!0,keepAliveListeningEvents:"click touchstart keydown",keepAliveOnInit:!0,keepAliveInterval:9,showLinks:!0,tabIndex:-1,accessKeys:!1,notificationsNrToLoad:5,debug:!1};void 0!==c&&(O=c.toLowerCase());u=function(e){return new URL(e)}(logoutURL()).origin;s=[{description:_[O].userProfile,url:u+"/selfadmin/?lang="+O,iconclass:"widget_icon_profile"}];var W=u+"/selfadmin/messages/?lang="+O;function isHTML5StorageSupported(){try{return"sessionStorage"in window&&null!==window.sessionStorage}catch(e){return log("No local storage available"),!1}}function log(e){U.debug&&window.console&&window.console.log&&console.log("["+function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"1-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+","+e.getMilliseconds()}()+"] - KLP.WIDGET - "+e)}function random(){return Math.floor(999999999*Math.random()+1)}function text(e){return _[O][e]}function accessKey(e){return!1===U.accessKeys||null==E[e]["access-key"]?"":'accesskey="'+E[e]["access-key"]+'"'}function tabIndex(e){return U.tabIndex<0?0:E[e]["tab-index"]+U.tabIndex}function join(e,n){return void 0===n?e:-1===e.indexOf("?")?e+"?"+n:e+"&"+n}function loginURL(){return join(o,function(){var n="";return e.each({app:t,service:i,lang:O},function(e,t){-1===o.toLowerCase().indexOf(e.toLowerCase())&&(n.length>0&&(n+="&"),n+=e+"="+t)}),n.length>0?n:void 0}())}function logoutURL(){return join(r.logoutURL,"app="+t+"&lang="+O+"&service=klp&inIframe="+!1+"&logoutTargetURL="+U.logoutTargetURL)}function doLogout(e){log("Clearing cache and sessionData before starting the logout process"),x=void 0,removePersistedState(),log("Proceeding to logoutUrl with following path "+e),window.location.href=e}function setChangeAccountDialog(){e("#"+n+" #klp-widget-authenticated-menu-changecompany").on("click touch",function(t){return t.preventDefault(),e("#"+n+" #klp-widget-authenticated-menu-changecompany").focus(),function(){if(void 0!==x&&x.support){if(isChangeUserAndProfile())var t=text("change-account-support-dialog");else var t=text("change-company-support-dialog");var i=logoutURL()}else{if(isChangeUserAndProfile())var t=text("change-account-confirm-dialog");else var t=text("change-company-confirm-dialog");var i=logoutURL()+"&changecompany=true"}if(0===e("#"+n+" #klp-widget-authenticated-changecompanydialog").length){var o='<div id="changeAccountModal" class="modal"><div class="modal-content"><div class="modal-text-container row"><div class="col-12 text-align-center"><i class="pi pi-2086"></i></div><span class="close">&times;</span><div class="col-1"></div><div class="col-10 text-align-center"><p class="modal-text">'+t+"</div></div></div>";e("#"+n+" .klp-widget-authenticated").append(o);var a=document.getElementById("changeAccountModal");a.style.display="table";var s=document.getElementsByClassName("close")[0];s.onclick=function(){a.parentElement.removeChild(a)},window.onclick=function(e){e.target===a&&a.parentElement.removeChild(a)},e("#klp-widget-authenticated-dochangecompany").on("click touch",function(t){return t.preventDefault(),e("#"+n+" #klp-widget-authenticated-dochangecompany").focus(),doLogout(i),!1})}}(),!1})}function setUserActive(){I=!0}function restoreState(){var n=function(){if(isHTML5StorageSupported()){var n=sessionStorage.getItem(p);if(n)try{var t=e.parseJSON(n);if(t.ttl>(new Date).getTime()&&function(e){var n=hash(e),t=getControlCookieVal("hash");if(n===t)return!0;if(void 0===t&&!isCurrentLocationPostCh())return log("Cache validated because on a different host=["+window.location.hostname+"] than control cookie domain=["+m+"]"),!0;return log("PersistedData are invalid [hashPersistedData="+n+",control cookie="+t+"]"),!1}(t.sessionData))return log("Valid persisted state loaded: "+n),t;log("Persisted state expired or invalid"),removePersistedState(),setControlCookie("all","sub")}catch(e){log("Persisted state was invalid due to error '"+e+"'"),removePersistedState(),setControlCookie("all","sub")}else log("No persisted state found")}else log("State not loaded because HTML storage not supported");return null}();n&&(w=n.address,y=!0,x=n.sessionData,renderWidget(),isCurrentLocationPostCh()&&renderNotificationsWidget(function(n){var t=v+n;if(isHTML5StorageSupported()){var i=sessionStorage.getItem(t);if(i){var o=e.parseJSON(i);return log("Document "+n+" has been read from cache with value "+o),o}}return null}(D)))}function removePersistedState(){isHTML5StorageSupported()?(sessionStorage.removeItem(p),log("Persisted state removed"),y?(document.cookie=f+"=sub; Path=/; domain="+m,log("Control cookie set to sub")):(document.cookie=f+"=; Path=/; Expires=Wed, 01 Apr 2014 01:00:00 GMT; domain="+m,log("Control cookie removed"))):log("Persisted state not removed because HTML storage not supported")}function isCurrentLocationPostCh(){return window.location.hostname.match(h)}function hash(e){var n,t,i=0;if(0===(e=JSON.stringify(e)).length)return i;for(n=0,t=e.length;n<t;n++)i=(i<<5)-i+e.charCodeAt(n),i|=0;return i}function getControlCookieVal(e){var n=b.exec(document.cookie);if(null!=n){var t=decodeURIComponent(n[1]).split(":");switch(e){case"hash":if(null!=t[0])return t[0];break;case"keepalive":if(null!=t[1])return t[1];break;default:return decodeURIComponent(n[1])}return null}return log("Control cookie not found"),null}function setControlCookie(e,n){switch(e){case"hash":document.cookie=f+"="+n+":"+getControlCookieVal("keepalive")+"; Path=/; domain="+m+"; SameSite=None; Secure";break;case"keepalive":document.cookie=f+"="+getControlCookieVal("hash")+":"+n+"; Path=/; domain="+m+"; SameSite=None; Secure";break;default:document.cookie=f+"="+n+"; Path=/; domain="+m+"; SameSite=None; Secure"}}function removeDocumentFromCache(e){var n=v+e;isHTML5StorageSupported()&&(sessionStorage.removeItem(n),log("Document "+e+" has been removed from cache"))}function keepAliveTimerFunction(){I?(I=!1,_keepAliveSessions()):log("Keepalive call canceled due to user inactivity")}function installKeepAliveTimerHandler(){U.keepAlive&&void 0===P&&(U.keepAliveListeningEvents.length>0&&e(document).on(U.keepAliveListeningEvents,setUserActive),P=window.setInterval(keepAliveTimerFunction,60*U.keepAliveInterval*1e3))}function uninstallKeepAliveTimerHandler(){U.keepAlive&&(U.keepAliveListeningEvents.length>0&&e(document).off(U.keepAliveListeningEvents,setUserActive),P&&(window.clearInterval(P),P=void 0))}function _keepAliveSessions(){if(_isUserAuthenticated()){var n="<img src='"+r.keepAliveURL+"/?"+random()+"'><img src='"+M.keepalive+"?"+random()+"'>";e("#"+g).html(n),"function"==typeof S&&S(),setControlCookie("keepalive",(new Date).getTime())}}function renderAuthenticatedWidget(){e("#"+n).off("click touch");var t="",i="";"B2C"===x.userType?i="klp-widget-authenticated-session-name u_var_centered":(t=x.company,i="klp-widget-authenticated-session-name");var o="klp-widget-authenticated";x.support&&(o+=" klp-widget-support"),e("#"+n).html('<div class="'+o+'"><div class="klp-widget-authenticated-session klp-widget-menu-close"><a href="about:blank" role="button" class="klp-widget-authenticated-session-link klp-widget__user" title="'+text("title-text-menu")+'" tabindex="'+tabIndex("toggle-menu")+'" '+accessKey("toggle-menu")+' data-dropdown="klp-widget-authenticated-menu" aria-expanded="false" aria-controls="authenticated-menu"><div class="'+i+'">'+x.name+"&nbsp;"+x.surname+'</div><span class="initials-mobile">'+x.name.substring(0,1)+x.surname.substring(0,1)+'</span><span class="notification-number"></span></a>'+function(n,t){var i="",o="name",a="info";void 0!==s&&(-1!==n.indexOf("centered")&&(o="nameCentered"),0===t.length&&(a="infoHidden"),i+='<li class="name-and-surname"><div class="initials-circle"><div class="initials-container"><div>'+x.name.substring(0,1)+x.surname.substring(0,1)+'</div></div></div><div class="nameAndInfoWrapper"><span class="'+o+'">'+x.name+"&nbsp;"+x.surname+'</span><span class="'+a+'">'+t+"</span></div></li>",e.each(s,function(e,n){i+='<li><a class="notification-link" title="'+n.description+'" href="'+n.url+'"><div class="'+n.iconclass+'"></div><div class="linkContainer"><span class="klp-widget-notification-link-text">'+n.description+"</span></div></a></li>"}),i+='<li><a class="notification-link" title="'+text("title-text-notifications")+'" href="'+W+'"><div class="widget_icon_notification"></div><div class="linkContainer"><span class="klp-widget-notification-link-text">'+text("title-text-notifications")+'</span><span class="notification-number-detail"></span></div></a></li>');var c="";isOldChangeCompany()?c='<li><a id="klp-widget-authenticated-menu-changecompany" class="notification-link" tabindex="'+tabIndex("change-company")+'" '+accessKey("change-company")+' href="about:blank" role="button" title="'+text("change-company")+'"><div class="widget_icon_changecompany"></div><div class="linkContainer"><span class="klp-widget-notification-link-text">'+text("change-company")+"</span></div></a></li>":isChangeUserAndProfile()&&(c='<li><a id="klp-widget-authenticated-menu-changecompany" class="notification-link" tabindex="'+tabIndex("change-account")+'" '+accessKey("change-company")+' href="about:blank" role="button" title="'+text("change-account")+'"><div class="widget_icon_changecompany"></div><div class="linkContainer"><span class="klp-widget-notification-link-text">'+text("change-account")+"</span></div></a></li>");return'<div class="klp-widget-authenticated-menu" id="authenticated-menu" data-dropdown-toggler="klp-widget__user"><ul>'+i+c+'<li><a id="klp-widget-authenticated-menu-logout" class="notification-link" tabindex="'+tabIndex("sign-out")+'" '+accessKey("sign-out")+' title="'+text("sign-out")+'" href="about:blank" role="button"><div class="widget_icon_logout"></div><div class="linkContainer"><span class="klp-widget-notification-link-text">'+text("sign-out")+"</span></div></a></li></ul></div>"}(i,t)+"</div></div>"),e(".notification-number").css("visibility","hidden"),e(".notification-number-detail").css("visibility","hidden"),function(n,t){e(n).append('<div id="'+t+'" style="display:none;"></div>')}("#"+n,g),e("#"+n+" .klp-widget__user").on("click touch",function(t){return t.preventDefault(),e("#"+n+" .klp-widget__user").focus(),function(t){if(t.is(":visible"))return e("#"+n).removeClass("bubble"),void closeDropdowns();closeDropdowns(),e("."+t.attr("data-dropdown-toggler")).attr("aria-expanded",!0),e("#"+n).addClass("bubble"),t.show(),e(document).on("click",closeDropdowns),t.hasClass("klp-widget-authenticated-menu")&&t.parent().removeClass("klp-widget-menu-close").addClass("klp-widget-menu-open")}(e("#"+n+" .klp-widget-authenticated-menu")),0!==T?T>99?e(".notification-number-detail").css("visibility","visible").text("99+"):e(".notification-number-detail").css("visibility","visible").text(T):e(".notification-number-detail").css("visibility","hidden"),!1}),e("#"+n+" #klp-widget-authenticated-menu-logout").on("click touch",function(t){return t.preventDefault(),e("#"+n+" #klp-widget-authenticated-menu-logout").focus(),doLogout(logoutURL()),!1}),(isOldChangeCompany()||isChangeUserAndProfile())&&setChangeAccountDialog(),e(".klp-widget__user").on("keydown",function(n){if(!(n.which<37||n.which>40)){n.preventDefault();var t=e(this).parent(),i=e("."+e(this).attr("data-dropdown"));switch(n.which){case 37:t.prev().length&&t.prev().find("a").focus(),i.is(":visible")&&e(this).click();break;case 38:i.is(":visible")&&e(this).click();break;case 39:t.next().length&&t.next().find("a").focus(),i.is(":visible")&&e(this).click();break;case 40:i.is(":visible")||e(this).click(),i.find("li:first a").focus()}}}),e(".klp-widget-authenticated-menu").on("keydown","a",function(n){if(!(n.which<37||n.which>40)){n.preventDefault();var t=e(this).parent(),i=e("."+e(this).parents("div").first().attr("data-dropdown-toggler"));switch(n.which){case 37:case 38:t.prev("li").length>0?t.prev("li").find("a").focus():i.click().focus();break;case 39:case 40:t.next("li").length>0&&t.next("li").find("a").focus()}}}),e("body").on("keydown",function(e){27===e.which&&closeDropdowns()})}function isOldChangeCompany(){return"B2B"===x.userType&&x.canChangeCompany&&null==x.changeUserAndProfile||null!=x.changeUserAndProfile&&"profile"===x.changeUserAndProfile}function isChangeUserAndProfile(){return null!=x.changeUserAndProfile&&"userAndProfile"===x.changeUserAndProfile}function showDocument(e,n){switch(n){case D:renderNotificationsWidget(e),function(e,n){var t=v+n;isHTML5StorageSupported()&&(sessionStorage.setItem(t,JSON.stringify(e)),log("Document "+n+" has been persisted on cached with value "+JSON.stringify(e)))}(e,D);break;default:log("Unknown documentType received: "+n)}"function"==typeof A[n]&&A[n](e)}function renderNotificationsWidget(n){null!=n&&e(".notification-number").text()!==n.unreadNotifications&&(0===(T=n.unreadNotifications)?e(".notification-number").css("visibility","hidden"):e(".notification-number").css("visibility","visible"))}function _isUserAuthenticated(){return void 0!==x}function changeLoginURL(e){void 0!==e&&(o=e,renderWidget(),log("Widget appLoginURL has been replaced with "+o))}function login(e,n,t){x=e,renderWidget(),installKeepAliveTimerHandler(),function(e){isHTML5StorageSupported()?(sessionStorage.setItem(p,'{"ttl": '+((new Date).getTime()+e)+',"sessionData": '+JSON.stringify(x)+', "address":"'+w+'"}'),log("State persisted"),setControlCookie("hash",encodeURIComponent(hash(x)))):log("State not persisted because HTML storage not supported")}(n),t&&"function"==typeof C&&(C(),log("loginCallback has been called: "+C))}function logout(){x=void 0,w=void 0,removePersistedState(),removeDocumentFromCache(D),renderWidget(),uninstallKeepAliveTimerHandler(),"function"==typeof L&&L()}function handleMessage(n){switch(log("Message received: "+JSON.stringify(n)),function(n){var t=JSON.stringify({adr:w,evt:n});n.adt?(log("Sending auditing event: "+t),e.ajax({type:"POST",url:M.audit,xhrFields:{withCredentials:!0},crossDomain:!0,data:t})):log("Auditing disabled: "+t)}(n),y=!1,n.typ){case"ukn":n.sub?(y=!0,logout(),subscribe()):logout();break;case"sub":w=n.adr,login(n.data,n.ttl,!1),openCommunication();break;case"hi":login(n.data,n.ttl,!0),removeDocumentFromCache(D);break;case"bye":logout();break;case"doc":showDocument(n.doc,n.doctyp);break;case"rem":!function(e){switch(e){case D:removeDocumentFromCache(D);break;default:log("Unknown documentType received: "+e)}"function"==typeof A[e]&&A[e](void 0)}(n.doctyp);break;default:log("Unknown event received: "+n.typ),logout()}}function subscribe(){if(w)log("Address available, skipping subscription"),openCommunication();else if(isCurrentLocationPostCh()&&null==getControlCookieVal())log("Control cookie not found, skipping subscription"),renderWidget();else{log("Subscribing to get an address");var n=(new Date).getTime();e.ajax({url:M.subscribe,type:"GET",xhrFields:{withCredentials:!0},crossDomain:!0}).done(function(e){handleMessage(e)}).fail(function(e,n){log("Failed to subscribe: "+n),logout(),renderWidget()}),function(e,n){U.debug&&window.console&&window.console.log&&log("Method "+e+" executed on "+n+" ms")}("subscribe()",(new Date).getTime()-n)}}function openCommunication(){k||((k=new a.EventBus(M.eventbus,{debug:U.debug,devel:U.debug})).onopen=function(){log("EventBus opened"),k&&k.registerHandler(w,function(e,n){handleMessage(e)}),e(window).on("beforeunload",closeCommunication)},k.onclose=function(){log("EventBus closed"),log("Communication closed with retrySubscribeOnFail="+y+". Retrying subscribe"),k=null,e(window).off("beforeunload",closeCommunication),y&&(y=!1,w=void 0,subscribe())})}function closeCommunication(){k&&k.close()}function renderWidget(){void 0!==x?renderAuthenticatedWidget():(e("#"+n).addClass("anonymous"),e("#"+n).attr("data-custom-focus-id","klp-widget"),e("#"+n).html('<div class="klp-widget-anonymous"><div class="klp-widget-anonymous__wrapper"><a tabindex="'+tabIndex("sign-in")+'" '+accessKey("sign-in")+' title="'+text("sign-in")+'" href="'+loginURL()+'" data-custom-focus-target="klp-widget" data-custom-focus-direction="parent"><span class="klp-widget-anonymous__text">'+text("sign-in")+'</span><svg class="ppm-svg-icon ppm-main-navigation__login-icon" focusable="false"><use xlink:href="#2064_arrow-enter"></use></svg></a></div></div>'),e("#"+n).on("click touch",function(e){return e.preventDefault(),document.location.href=loginURL(),!1})),N&&(log("Widget shows up in "+((new Date).getTime()-N)+" [msec]"),N=void 0),e(".klp-widget-authenticated-session-link").click()}function closeDropdowns(t){null!=t&&e(t.target).parents("#"+n).length>0||(e(document).off("click",closeDropdowns),e("#"+n).removeClass("bubble"),e("#"+n+" .klp-widget-authenticated-menu").hide().parent().removeClass("klp-widget-menu-open").addClass("klp-widget-menu-close"),e("."+e("#"+n+" .klp-widget-authenticated-menu").attr("data-dropdown-toggler")).attr("aria-expanded",!1))}return void 0!==l&&(U=e.extend(U,l)),restoreState(),subscribe(),U.keepAliveOnInit&&_isUserAuthenticated()&&function(){var e=(new Date).getTime(),n=getControlCookieVal("keepalive");if(isNaN(n)||e-parseInt(n)>60*U.keepAliveInterval*1e3)return log("Running keepAliveSessionsOnInit"),void _keepAliveSessions();log("keepAliveSessionsOnInit not running due to [now="+e+",last="+n+",interval="+60*U.keepAliveInterval*1e3)}(),function(){function receiveMessage(e){"syncWidget"===e.data&&(log("PostMessage syncWidget received"),subscribe())}log("Preparing for communication with iframe content"),window.addEventListener?window.addEventListener("message",receiveMessage):window.attachEvent("onmessage",receiveMessage)}(),{keepAliveSessions:function(){_keepAliveSessions()},isUserAuthenticated:function(){return _isUserAuthenticated()},getUserType:function(){return _isUserAuthenticated()?x.userType:"NONE"},getCurrentAuthLevel:function(){return _isUserAuthenticated()?x.authLevel:"NONE"},changeAppLoginURL:function(e){changeLoginURL(e)},updateWidget:function(n){!function(n){void 0!==n&&(U=e.extend(U,n),renderWidget()),log("Widget has been updated")}(n)},registerLoginCallback:function(e){log("Login callback has been registered"),C=e},unregisterLoginCallback:function(){log("Login callback has been un-registered"),C=void 0},registerKeepAliveCallback:function(e){log("KeepAlive callback has been registered"),S=e},unregisterKeepAliveCallback:function(){log("KeepAlive callback has been un-registered"),S=void 0},registerLogoutCallback:function(e){log("Logout callback has been registered"),L=e},unregisterLogoutCallback:function(){log("Logout callback has been un-registered"),L=void 0},registerDocumentCallback:function(e,n){log("Document callback for documentType "+e+" has been registered"),A[e]=n},unregisterDocumentCallback:function(e){log("Document callback for documentType "+e+" has been un-registered"),A[e]=void 0},registerShowLinksCallback:function(e){log("Show links callback has been registered"),e},unregisterShowLinksCallback:function(){log("Show links callback has been un-registered"),void 0},version:function(){return"16.01.00.01"},setDebug:function(e){U.debug=e}}}}(jQuery),window.POSTPP&&window.jQuery.noConflict(!0)}}]);